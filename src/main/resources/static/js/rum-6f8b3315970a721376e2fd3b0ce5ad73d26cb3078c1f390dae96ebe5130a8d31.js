var WindowEvent;!function(e){e[e.Load="load"]="Load",e[e.BeforeUnload="beforeunload"]="BeforeUnload",e[e.Abort="abort"]="Abort",e[e.Error="error"]="Error"}(WindowEvent||(WindowEvent={}));var AjaxTiming=function(){function e(e,t,n,r){var o=this;this.getPerformanceTimings=function(e){o.connect=e.connectEnd-e.connectStart,o.dns=e.domainLookupEnd-e.domainLookupStart,o.duration=e.duration,o.load=e.responseEnd-e.responseStart,o.wait=e.responseStart-e.requestStart,o.start=e.startTime,o.redirect=e.redirectEnd-e.redirectStart,e.secureConnectionStart&&(o.ssl=e.connectEnd-e.secureConnectionStart)},this.url=e,this.method=t,this.isAsync=n,this.open=r}return e}(),ProfilerJsError=function(){function e(e,t,n){this.count=0,this.message=e,this.url=t,this.lineNumber=n}return e.createText=function(e,t,n){return[e,t,n].join(":")},e.prototype.getText=function(){return e.createText(this.message,this.url,this.lineNumber)},e}(),ProfilerEventManager=function(){function e(){this.events=[],this.hasAttachEvent=!!window.attachEvent}return e.prototype.add=function(e,t,n){this.events.push({type:e,target:t,func:n}),this.hasAttachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,!1)},e.prototype.clear=function(){for(var e,t=0,n=this.events;t<n.length;t++)e=n[t],this.hasAttachEvent?e.target.detachEvent(e.type,e.func):e.target.removeEventListener(e.type,e.func,!1);this.events=[]},e}(),RProfiler=function(){function e(){function e(e){var n=e.target||e.srcElement;return 3==n.nodeType&&(n=n.parentNode),t("N/A",n.src||n.URL,-1),!1}var t,n,r,o,i,a=this;this.restUrl="g.3gl.net/jp/111/v3/M",this.startTime=(new Date).getTime(),this.info={},this.hasInsight=!1,this.data={start:this.startTime,jsCount:0,jsErrors:[],loadTime:-1,loadFired:!1,ajax:[]},this.eventManager=new ProfilerEventManager,this.startAjaxCapture=function(){var e,t=XMLHttpRequest.prototype,n=t.open,r=t.send,o=[],i={},s=a.data.ajax,c=25,u="object"==typeof performance&&"function"==typeof window.performance.now&&"function"==typeof window.performance.getEntriesByType;u&&window.performance.setResourceTimingBufferSize(300),e=function(){return u?window.performance.now():(new Date).getTime()},t.open=function(t,r,i,a,s){void 0===i&&(i=!0),this.rpIndex=o.length,o.push(new AjaxTiming(r,t,i,e())),n.call(this,t,r,i,a,s)},t.send=function(t){var n,a=this,l=this.onreadystatechange;this.onreadystatechange=function(){var t,n,r=o[a.rpIndex];if(r){switch(t=a.readyState){case 1:r.connectionEstablished=e();break;case 2:r.requestReceived=e();break;case 3:r.processingTime=e();break;case 4:switch(r.complete=e(),n=!(!a.response||null==a.response||void 0==a.response),a.responseType){case"text":case"":"string"==typeof a.responseText&&(r.responseSize=a.responseText.length);break;case"json":n&&"function"==typeof a.response.toString&&(r.responseSize=a.response.toString().length);break;case"arraybuffer":n&&"number"==typeof a.response.byteLength&&(r.responseSize=a.response.byteLength);break;case"blob":n&&"number"==typeof a.response.size&&(r.responseSize=a.response.size)}!function(e){setTimeout(function(){var t,n,r,o,a;if(u){var c=e.url,l=[],f=performance.getEntriesByType("resource");for(t=0,n=f;t<n.length;t++)r=n[t],r.name==c&&l.push(r);if(s.push(e),0!=l.length){if(i[c]||(i[c]=[]),1==l.length)return e.getPerformanceTimings(l[0]),void i[c].push(0);o=i[c];for(a in l)if(-1==o.indexOf(a))return e.getPerformanceTimings(l[a]),void o.push(a);e.getPerformanceTimings(l[0])}}},c)}(r,s)}"function"==typeof l&&l.call(a)}},(n=o[this.rpIndex])&&(t&&!isNaN(t.length)&&(n.sendSize=t.length),n.send=e(),r.call(this,t))}},this.recordPageLoad=function(){a.data.loadTime=(new Date).getTime(),a.data.loadFired=!0},this.addError=function(e,t,n){var r,o,i,s,c;for(a.data.jsCount++,r=ProfilerJsError.createText(e,t,n),o=a.data.jsErrors,i=0,s=o;i<s.length;i++)if(c=s[i],c.getText()==r)return void c.count++;o.push(new ProfilerJsError(e,t,n))},this.addInfo=function(e,t,n){if(!a.isNullOrEmpty(e)){if(a.isNullOrEmpty(n))a.info[e]=t;else{if(a.isNullOrEmpty(t))return;a.isNullOrEmpty(a.info[e])&&(a.info[e]={}),a.info[e][t]=n}a.hasInsight=!0}},this.clearInfo=function(){a.info={},a.hasInsight=!1},this.getInfo=function(){return a.hasInsight?a.info:null},this.eventManager.add(WindowEvent.Load,window,this.recordPageLoad),t=this.addError,this.startAjaxCapture(),window.opera?this.eventManager.add(WindowEvent.Error,document,e):"onerror"in window&&(n=window.onerror,window.onerror=function(e,r,o){return t(e,r,o),!n?!1:n(e,r,o)}),!window.__cpCdnPath||(this.restUrl=window.__cpCdnPath.trim()),r=document.createElement("iframe"),o=r.style,o.position="absolute",o.top="-10000px",o.left="-1000px",i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(r,i);var s=r.contentWindow.document.open("text/html","replace"),c=window.location.protocol+"//",u='<body onload="';u+="function s(u){var d=document,s=d.createElement('script');s.type='text/javascript';s.src=u;d.body.appendChild(s);}",u+="s('"+c+this.restUrl+"');",u+='"></body>',s.write(u),s.close()}return e.prototype.isNullOrEmpty=function(e){if(void 0===e||null===e)return!0;if("string"==typeof e){var t=e;return 0==t.trim().length}return!1},e.prototype.dispatchCustomEvent=function(e){!function(e){function t(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return"function"==typeof e.CustomEvent?!1:(t.prototype=Event.prototype,void(e.CustomEvent=t))}(window);var t=new CustomEvent(e);window.dispatchEvent(t)},e}(),profiler=new RProfiler;window.RProfiler=profiler,window.WindowEvent=WindowEvent,profiler.dispatchCustomEvent("GlimpseLoaded");